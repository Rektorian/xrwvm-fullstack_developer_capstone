I - Run locally

1. Run the Mongo Server:

Navigate to: cd /home/project/xrwvm-fullstack_developer_capstone/server/database

podman build . -t nodeapp
podman-compose up

copy the URL from the address bar/container from host 3030, e.g.:
(Make sure that the / at the end is not copied.)
backend_url=http://localhost:3030

Open djangoapp/.env and replace the your backend url with the URL from host 3030

2. Environment setup:
cd /home/project/xrwvm-fullstack_developer_capstone/server

pip install virtualenv
virtualenv djangoenv
source djangoenv/bin/activate

python3 -m pip install -U -r requirements.txt

python3 manage.py makemigrations
python3 manage.py migrate
python3 manage.py runserver

3. Deploy sentiment analysis on local machine as a microservice:

Navigate to: cd xrwvm-fullstack_developer_capstone/server/djangoapp/microservices

podman build . -t senti_analyzer
podman run --rm -it -p 5000:5000 senti_analyzer

copy url to djangoapp/.env, e.g.:
(It is essential to include the / at the end of the URL. Please ensure that it is copied.)
sentiment_analyzer_url=http://localhost:5000/

-------------------------------------------------------------------------

II. How to run as image from K8s in podman:

1. Create DockerFile & entrypoint.sh in server directory:

2. Run to build image (it will take 10-20min):
podman build . -t dealership --log-level=debug --progress=plain --format=docker

3. K8s steps:
Set deployment/yaml to:
      containers:
      - image: localhost/dealership:latest
        imagePullPolicy: Never
        name: dealership
        ports:
        - containerPort: 8000
          hostPort: 8080 # add for port forwarding, e.g. here it will be accessible under port 8080
          protocol: TCP

4. run to deploy
podman play kube deployment.yaml
remove with:
podman pod stop dealership-pod
podman pod rm dealership-pod